<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<link href="/css/main.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" type="text/css" href="/css/style.css" />
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
		<link rel="stylesheet" type="text/css" href="/css/main.css" />
		<link rel="stylesheet" type="text/css" href="/css/style.css" />
		<script type="text/javascript" src="depend/lib/jquery/jquery-1.9.0.min.js" ></script>
		<script src="js/cvi_busy_lib.js" type="text/javascript"></script>
		<link href="depend/lib/ligerUI/skins/Aqua/css/ligerui-all.css" rel="stylesheet" type="text/css" />
		<script src="depend/lib/ligerUI/js/ligerui.min.js" type="text/javascript"></script>
	</head>
	<body>
		<div class="main">
			<div class="indiv">
				<form data-type="formAction" id ="QueryWinTest">
					<table>
						<tr>
							<td>测试id</td>
							<td>
								<select id="testId">
									{{range .TestIds}}
										<option value={{.}}>{{.}}</option>
									{{end}}
								</select>
							</td>
						</tr>
						<tr>
							<td>武将index</td><td><input type="text" name="testIndex" id="testIndex" value="" width=300></input></td>
						</tr>
					</table>
				</form>
				<input type="submit" class="button" value="查询测试结果" onclick="QueryWinTest()" ></input>
			</div>
			<div id="infoGrid"></div>
		</div>
	</body>
	<script type="text/javascript">
		function QueryWinTest(obj) {
            $("#infoGrid").hide();
            ctrl = getBusyOverlay("viewport");
            var formobj = document.getElementById("QueryWinTest");
            $.post("/QueryWinTest",
                {
                    testId :  $("#testId").val(),
                    testIndex : $("#testIndex").val(),
                },
				//$(formobj).serialize(),
				function (ret) {
                try {ctrl.remove(); delete ctrl;} catch(e) {}
                if (ret.Ret != 0){
                    alert(ret.Reason);
                    return;
                }
                $("#infoGrid").show();
                manager = $("#infoGrid").ligerGrid({
                    columns: [
                        { display: '测试索引', name: 'Index', width: 200, type: 'int', frozen:true },
                        { display: '胜场', name: 'Win', width: 200, type: 'int', frozen:true },
                        { display: '总场次', name: 'Total', width: 200, type: 'text', frozen:true},
                        { display: '胜率', name: 'Rate', width: 100, type: 'int', frozen:true},
                    ],
                    // onSelectRow: onGridSelect,
                    enabledEdit: false, clickToEdit: false, isScroll: true, pageSize:100,
                    data:{
                        Rows: ret.Data,
                        Total: ret.Data.Length,
                    },
                    width: 800
                });
            }, "json")
        }
	</script>
</html>
