<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<link href="/css/main.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" type="text/css" href="/css/style.css" />
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
		<link rel="stylesheet" type="text/css" href="/css/main.css" />
		<link rel="stylesheet" type="text/css" href="/css/style.css" />
		<script type="text/javascript" src="depend/lib/jquery/jquery-1.9.0.min.js" ></script>
		<script src="js/cvi_busy_lib.js" type="text/javascript"></script>
		<link href="depend/lib/ligerUI/skins/Aqua/css/ligerui-all.css" rel="stylesheet" type="text/css" />
		<script src="depend/lib/ligerUI/js/ligerui.min.js" type="text/javascript"></script>
	</head>
	<body>
		<div id="ainfoGrid"></div>
	</body>
	<script type="text/javascript">
        var manager, g;
		$(function() {
            //初始化grid
            function itemclick(item) {
                alert(item.text);
            }
            var typeData = [];
            var rowData = {Rows: {{.Info}}};
            g = manager = $("#ainfoGrid").ligerGrid({
                columns: [
					{display: 'ID', name: 'id', align: 'center', width: 200, editor: {type: 'text'}},
					{display: '提交人员', name: 'who', align: 'center', width: 120, editor: {type: 'text'}},
					{display: '时间', name: 'time', width: 200, align: 'center', editor: {type: 'text'}},
                    {display: '操作', name: 'name', align: 'center', width: 200, editor: {type: 'text'}},
                    {display: '描述', name: 'desc', width: 360, align: 'left', editor: {type: 'text'}},
					{
						display: '审核', width: 200, name: 'type',
						editor: {type: 'text', data: typeData, valueColumnName: 'val'},
						render: function (item) {
							return "<input type=\"button\"  value=\"同意\" onclick=\"ActionVerify(" + item.id +", 1)\" ></input><input type=\"button\"  value=\"拒绝\" onclick=\"ActionVerify(" + item.id +", 0)\" ></input>"
						}
					},
                ], sortName: 'name', enabledEdit: false, data: rowData,
                onSelectRow: function (rowdata, rowindex) {
                   // $("#txtrowindex").val(rowindex);
                },
                width: '98%', height: '350', usePager: false, clickToEdit: false, checkbox: false
            });
        });

		function ActionVerify(vid, vt) {
			ctrl = getBusyOverlay("viewport");
			$.post("/v9/DoActionVerify",  {id:vid, t:vt}, function(ret){
				try {ctrl.remove(); delete ctrl;} catch(e) {}
				if (ret.Ret != 0){
					alert(ret.Reason);
				}
				location.replace("/action_verify")
			},"json")
        }
	</script>
</html>
